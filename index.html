<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Adult Smoking in the United States</title>
        <script src="https://d3plus.org/js/d3plus.v2.0.0-alpha.13.full.min.js"></script>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <style>
          #viz {
            background-color: grey;
            height: 400px;
            padding: 50px;
            width: 600px;
          }
        </style>
        <link rel="stylesheet" href="style.css" />

    </head>
    <body>
    </body>
</html>
<script>

  d3.json("https://api.datausa.io/attrs/geo/", function(error, data) {
    d3plus.dataFold(data);
    var nameLookup = data.reduce(function(obj, d) {
      obj[d.id] = d.display.name;
      return(obj);
    }, {});
    console.log(nameLookup);
  });

  var chart = new d3plus.BarChart();

  var settings = {
    data: "https://api.datausa.io/api/?show=geo&geo=01000US,04000US25&required=year,income",
    discrete: "y",
      label(function(d) {
        return nameLookup[d.geo];
      })
    groupBy: "geo",
    select: "#viz",
    y: function(d) {
      return d.year;
  },
  x: function(d) {
    return d.income;
  }
};
  var arcStyles = {
    fill: function(d) {
      if (d.geo =="01000US") {
        return "orange";
      }
      else {
        return "rebeccapurple";
      }
    }
  }

  chart
  .config(settings)
  .shapeConfig(arcStyles)
  .render();

</script>
